Для данной задачи нужно знать свойства модуля числа.
Несмотря на возможность ввести пользователю большую последовательность цифр, все буквы будут сдвинуты на одинаковое число t.
ch1 = ch + t
Чтобы восстановить исходный текст нужно сдвинуть текст на число 128 - t
Тогда:
(ch + t - t + 128) mod 128 = ch
Следует помнить, что первоначальный текст изначально был зашифрован base64.