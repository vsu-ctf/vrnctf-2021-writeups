В описание сказано, что используется алгоритм Диффи - Хеллмана. Обычно данный алгоритм нужен для создания совместного закрытого ключа.
Man-in-the-middle одна из известных атак на данный алгоритм. Необходимо сформировать закрытую пару ключей K1,K2 для Трисс и Йеннифер.
Атака будет состоять из следующих шагов:
1. Придумать параметры a, b. Параметры p и g взять у Йеннифер. Сгенерировать публичные ключи А и В.
2. Послать Йеннифер сгенерированный публичный ключ B.
3. Послать Трисс параметры p и g и сгенерированный публичный ключ А.
4. Создать секретные ключи для Трисс и для Йеннифер: К1 = B^a mod p, K2 = A^b mod p.
В целях безопасности Трисс и Йеннифер решили использовать контрольное сообщение. Поэтому его нужно будет расшифровать одним ключом и зашифровать другим.
1. Получить от Йеннифер контрольное сообщение и расшифровать его, используя AES в режиме ECB, в качестве ключа использовать K2.
2. Расшифрованное контрольное сообщение зашифровать для Трисс, используя AES в режиме ECB, в качестве ключа использовать K1, и отправить его Трисс.
После этого Трисс передаст секретное сообщение, расшифровав его, получим флаг.