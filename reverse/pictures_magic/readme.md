Классическая задача из категории обратной разработки, в которой нужно восстановить испорченное изображение.

1. Декомилируем приложение в любом декомпиляторе.

2. Понимаем, что программа выполняет следующие действия:
   1. Инициализирует генератор случайных чисел: `srand(0xdeadbeef);`
   2. Заполняет в цикле массив `rowKey` из 1024-х элементов значениями `rowKey[i] = rand() % 128`. Так как `seed` генератора известен, можем восстановить массив или посмотреть значения его элементов в отладчике.
   3. Транспонирует исходное изображение с использованием нескольких операций `xor` при копировании цветов:

```c
    for (int i = 0; i < newWidth; i++) {
        for (int j = 0; j < newHeight; j++) {
            bmp_pixel* pixel = &img.img_pixels[i][j];

            unsigned char newR = pixel->red ^ keyData[0];

            bmp_pixel_init(&img2.img_pixels[j][i],
                pixel->blue ^ newR, pixel->green ^ newR, newR);
        }
    }

```

   4. Обновляет цвета пикселей с помощью следующего кода:

```c
    for (int i = 0; i < newHeight; i++) {
        for (int j = 0; j < newWidth; j++) {
            bmp_pixel* pixel1 = &img2.img_pixels[i][j];
            pixel1->red = pixel1->red ^ rowKey[j];
            pixel1->green = pixel1->green ^ rowKey[j];
            pixel1->blue = pixel1->blue ^ rowKey[j];
        }
    }
```

Для восстановления изображения выполняем те же самые действия в обратном порядке и получаем нарисованный флаг.

